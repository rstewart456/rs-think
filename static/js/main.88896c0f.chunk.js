(this["webpackJsonprs-think"]=this["webpackJsonprs-think"]||[]).push([[0],{32:function(e,t,a){e.exports=a(49)},37:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),s=(a(37),a(3)),o=a(4),l=a(6),i=a(5),u=a(7),m=a(19),p=a.n(m),d=a(8),h=a.n(d),f=a(14),b=a(16),v=a.n(b);a(40),a(43),a(50);v.a.initializeApp({apiKey:"AIzaSyB5mZksIwKC93gPi1p3uc5A0HNERkBcQ1c",authDomain:"think-piece-cb5eb.firebaseapp.com",databaseURL:"https://think-piece-cb5eb.firebaseio.com",projectId:"think-piece-cb5eb",storageBucket:"think-piece-cb5eb.appspot.com",messagingSenderId:"603056826506",appId:"1:603056826506:web:5cc4eeb9a34d438e"});var y=v.a.firestore(),E=v.a.auth(),g=v.a.storage(),C=new v.a.auth.GoogleAuthProvider,O=function(){return E.signInWithPopup(C)},j=function(){return E.signOut()};window.firebase=v.a;var w=function(e,t){var a,n,r,c,s;return h.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e){o.next=2;break}return o.abrupt("return");case 2:return a=y.doc("users/".concat(e.uid)),o.next=5,h.a.awrap(a.get());case 5:if(o.sent.exists){o.next=17;break}return n=e.displayName,r=e.email,c=e.photoURL,s=new Date,o.prev=9,o.next=12,h.a.awrap(a.set(Object(f.a)({displayName:n,email:r,photoURL:c,createdAt:s},t)));case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(9),console.error("Error creating user",o.t0.message);case 17:return o.abrupt("return",N(e.uid));case 18:case"end":return o.stop()}}),null,null,[[9,14]])},N=function(e){return h.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:return t.prev=2,t.abrupt("return",y.collection("users").doc(e));case 6:t.prev=6,t.t0=t.catch(2),console.error("Error fetching user",t.t0.message);case 9:case"end":return t.stop()}}),null,null,[[2,6]])},S=(v.a,a(13)),k=function(e){var t=e.displayName,a=e.photoURL,n=e.email,c=e.createdAt,s=e.children;return r.a.createElement("section",{className:"CurrentUser"},r.a.createElement("div",{className:"CurrentUser--profile"},a&&r.a.createElement("img",{src:a,alt:t}),r.a.createElement("div",{className:"CurrentUser--information"},r.a.createElement(S.b,{to:"/profile"},r.a.createElement("h2",null,t)),r.a.createElement("p",{className:"email"},n),r.a.createElement("p",{className:"created-at"},p()(c.Date).calendar()))),r.a.createElement("div",null,r.a.createElement("div",null,s),r.a.createElement("button",{onClick:j},"Sign Out")))};k.defaultProps={displayName:"Bill Murray",email:"billmurray@mailinator.com",photoURL:"https://www.fillmurray.com/300/300",createdAt:new Date};var A=k,x=a(10),U=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(x.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault(),a.setState({email:"",password:""})},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password;return r.a.createElement("form",{className:"SignIn",onSubmit:this.handleSubmit},r.a.createElement("h2",null,"Sign In"),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:t,onChange:this.handleChange}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:a,onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Sign In"}),r.a.createElement("button",{onClick:O},"Sign In With Google"))}}]),t}(n.Component),P=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={displayName:"",email:"",password:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(x.a)({},n,r))},a.handleSubmit=function(e){var t,n,r,c,s,o;return h.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e.preventDefault(),t=a.state,n=t.email,r=t.password,c=t.displayName,l.prev=2,l.next=5,h.a.awrap(E.createUserWithEmailAndPassword(n,r));case 5:s=l.sent,o=s.user,w(o,{displayName:c}),l.next=13;break;case 10:l.prev=10,l.t0=l.catch(2),console.log(l.t0);case 13:a.setState({displayName:"",email:"",password:""});case 14:case"end":return l.stop()}}),null,null,[[2,10]])},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.displayName,a=e.email,n=e.password;return r.a.createElement("form",{className:"SignUp",onSubmit:this.handleSubmit},r.a.createElement("h2",null,"Sign Up"),r.a.createElement("input",{type:"text",name:"displayName",placeholder:"Display Name",value:t,onChange:this.handleChange}),r.a.createElement("input",{type:"email",name:"email",placeholder:"Email",value:a,onChange:this.handleChange}),r.a.createElement("input",{type:"password",name:"password",placeholder:"Password",value:n,onChange:this.handleChange}),r.a.createElement("input",{type:"submit",value:"Sign Up"}))}}]),t}(n.Component),D=function(){return r.a.createElement("div",null,r.a.createElement(U,null),r.a.createElement(P,null))},R=Object(n.createContext)({user:null}),I=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={user:null},a.unsubscribeFromAuth=null,a.componentDidMount=function(){return h.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a.unsubscribeFromAuth=E.onAuthStateChanged((function(e){return h.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,h.a.awrap(w(e));case 3:t.sent.onSnapshot((function(e){a.setState({user:Object(f.a)({uid:e.id},e.data())})}));case 5:a.setState({user:e});case 6:case"end":return t.stop()}}))}));case 1:case"end":return e.stop()}}))},a.componentWillUnmount=function(){a.unsubscribeFromAuth()},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.user,t=this.props.children;return r.a.createElement(R.Provider,{value:e},t)}}]),t}(n.Component),F=function(e){var t=e.loading,a=Object(n.useContext)(R);return t?null:r.a.createElement("div",null,a?r.a.createElement(A,a):r.a.createElement(D,null))},L=function(e){var t,a,c=e.title,s=e.content,o=e.user,l=e.createdAt,i=e.stars,u=e.comments,m=e.id,d=Object(n.useContext)(R),h=y.doc("posts/".concat(m));return r.a.createElement("article",{className:"Post"},r.a.createElement("div",{className:"Post--content"},r.a.createElement(S.b,{to:"/posts/".concat(m)},r.a.createElement("h3",null,c)),r.a.createElement("div",null,s)),r.a.createElement("div",{className:"Post--meta"},r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"star"},"\u2b50\ufe0f"),i),r.a.createElement("p",null,r.a.createElement("span",{role:"img","aria-label":"comments"},"\ud83d\ude4a"),u),r.a.createElement("p",null,"Posted by ",o.displayName),r.a.createElement("p",null,p()(l.Date).calendar())),r.a.createElement("div",null,r.a.createElement("button",{className:"star",onClick:function(){return h.update({stars:i+1})}},"Star"),(a=o,!!(t=d)&&t.uid===a.uid&&r.a.createElement("button",{className:"delete",onClick:function(){return h.delete()}},"Delete")))))};L.defaultProps={title:"An Incredibly Hot Take",content:"Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ducimus est aut dolorem, dolor voluptatem assumenda possimus officia blanditiis iusto porro eaque non ab autem nihil! Alias repudiandae itaque quo provident.",user:{id:"123",displayName:"Bill Murray",email:"billmurray@mailinator.com",photoURL:"https://www.fillmurray.com/300/300"},createdAt:new Date,stars:0,comments:0};var B=L,W=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={title:"",content:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(x.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.title,r=t.content,c=E.currentUser||{},s={title:n,content:r,user:{uid:c.uid,displayName:c.displayName,email:c.email,photoURL:c.photoURL},favorites:0,comments:0,createdAt:new Date};y.collection("posts").add(s),a.setState({title:"",content:""})},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.title,a=e.content;return r.a.createElement("form",{onSubmit:this.handleSubmit,className:"AddPost"},r.a.createElement("input",{type:"text",name:"title",placeholder:"Title",value:t,onChange:this.handleChange}),r.a.createElement("input",{type:"text",name:"content",placeholder:"Body",value:a,onChange:this.handleChange}),r.a.createElement("input",{className:"create",type:"submit",value:"Create Post"}))}}]),t}(n.Component),q=function(e){return Object(f.a)({id:e.id},e.data())},M=Object(n.createContext)(),T=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={posts:[]},a.unsubscribeFromFirestore=null,a.componentDidMount=function(){a.unsubscribeFromFirestore=y.collection("posts").orderBy("createdAt","desc").onSnapshot((function(e){var t=e.docs.map(q);a.setState({posts:t})}))},a.componentWillUnmount=function(){a.unsubscribeFromFirestore()},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.posts,t=this.props.children;return r.a.createElement(M.Provider,{value:e},t)}}]),t}(n.Component),H=function(){var e=Object(n.useContext)(M);return r.a.createElement("section",{className:"Posts"},r.a.createElement(W,null),e.map((function(e){return r.a.createElement(B,Object.assign({},e,{key:e.id}))})))},z=a(15),G=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={displayName:""},a.imageInput=null,a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(x.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state.displayName;t&&a.userRef.update({displayName:t}),a.file&&g.ref().child("user-profiles").child(a.uid).child(a.file.name).put(a.file).then((function(e){return e.ref.getDownloadURL()})).then((function(e){return a.userRef.update({photoURL:e})}))},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.state.displayName;return r.a.createElement("section",{className:"UserProfile"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("input",{type:"text",value:t,name:"displayName",onChange:this.handleChange,placeholder:"Display Name"}),r.a.createElement("input",{type:"file",ref:function(t){return e.imageInput=t}}),r.a.createElement("input",{className:"update",type:"submit"})))}},{key:"uid",get:function(){return E.currentUser.uid}},{key:"userRef",get:function(){return y.doc("users/".concat(this.uid))}},{key:"file",get:function(){return this.imageInput&&this.imageInput.files[0]}}]),t}(n.Component),J=function(e){var t=e.content,a=e.user,n=e.createdAt;return r.a.createElement("article",{className:"Comment"},r.a.createElement("span",{className:"Comment--author"},a.displayName),r.a.createElement("span",{className:"Comment--content"},t),r.a.createElement("span",{className:"Comment--timestamp"},p()(n).calendar()))};J.defaultProps={title:"An Incredibly Hot Take",content:"Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ducimus est aut dolorem, dolor voluptatem assumenda possimus officia blanditiis iusto porro eaque non ab autem nihil! Alias repudiandae itaque quo provident.",user:{displayName:"Bill Murray",email:"billmurray@mailinator.com",photoURL:"https://www.fillmurray.com/300/300"},createdAt:new Date};var K=J,Q=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={content:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(x.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault(),a.props.onCreate(a.state),a.setState({content:""})},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.content;return r.a.createElement("form",{onSubmit:this.handleSubmit,className:"AddComment"},r.a.createElement("input",{type:"text",name:"content",placeholder:"Comment",value:e,onChange:this.handleChange}),r.a.createElement("input",{className:"create",type:"submit",value:"Create Comment"}))}}]),t}(n.Component),Z=function(e){var t=e.comments,a=e.onCreate;return r.a.createElement("section",{className:"Comments"},r.a.createElement(Q,{onCreate:a}),t.map((function(e){return r.a.createElement(K,Object.assign({},e,{key:e.id}))})))},V=function(e){var t=function(t){return r.a.createElement(R.Consumer,null,(function(a){return r.a.createElement(e,Object.assign({user:a},t))}))};return t.dispalyName="WithUser(".concat(function(e){return e.dispalyName||e.name||"Component"}(t),")"),t},X=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(l.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(r)))).state={post:null,comments:[],loaded:!1},a.unsubscribeFromPost=[],a.unsubscribeFromComments=[],a.componentDidMount=function(){return h.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a.unsubscribeFromPost=a.postRef.onSnapshot((function(e){var t=q(e);a.setState({post:t,loaded:!0})})),a.unsubscribeFromComments=a.commentsRef.onSnapshot((function(e){var t=e.docs.map(q);a.setState({comments:t})}));case 2:case"end":return e.stop()}}))},a.componentWillUnmount=function(){a.unsubscribeFromPost(),a.unsubscribeFromComments()},a.createComment=function(e){var t=a.props.user;a.commentsRef.add(Object(f.a)({},e,{user:t}))},a}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state,t=e.post,a=e.comments,n=e.loaded;return console.log(this.props),n?r.a.createElement("section",null,t&&r.a.createElement(B,t),r.a.createElement(Z,{comments:a,postId:t.id,onCreate:this.createComment})):r.a.createElement("p",null,"Loading\u2026")}},{key:"postId",get:function(){return this.props.match.params.id}},{key:"postRef",get:function(){return y.doc("/posts/".concat(this.postId))}},{key:"commentsRef",get:function(){return this.postRef.collection("comments")}}]),t}(n.Component),Y=Object(z.f)(V(X)),$=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("main",{className:"Application"},r.a.createElement(S.b,{to:"/"},r.a.createElement("h1",null,"Think Piece")),r.a.createElement(F,null),r.a.createElement(z.c,null,r.a.createElement(z.a,{exact:!0,path:"/",component:H}),r.a.createElement(z.a,{exact:!0,path:"/profile",component:G}),r.a.createElement(z.a,{exact:!0,path:"/posts/:id",component:Y})))}}]),t}(n.Component);Object(c.render)(r.a.createElement(S.a,null,r.a.createElement(I,null,r.a.createElement(T,null,r.a.createElement($,null)))),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.88896c0f.chunk.js.map